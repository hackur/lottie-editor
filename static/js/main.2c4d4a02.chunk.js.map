{"version":3,"sources":["editor.js","App.js","serviceWorker.js","index.js"],"names":["newShapeGroupKeyHash","toRGBADecimal","arr","map","v","i","Math","round","toRGBADecimalGradient","generateNewKeyHash","val","XXH","h32","toString","findItemPath","items","path","forEach","item","it","length","colorObj","itemPath","push","itemName","nm","concat","ty","c","a","color","k","type","keyFramed","colors","startColor","s","endColor","e","time","t","start","end","index","g","extractColors","layers","rootLayersName","assetsIndex","shapes","layerId","layerName","shapeId","shapeName","parseColors","jsn","file","parsed","JSON","parse","join","rootItemName","split","trim","key","hasOwnProperty","assets","asset","setGradientKValue","new_color","startIndex","j","count","getLastkeyFramedColor","obj","assignNewGradientColor","json","colorProps","newColor","pickedColor","parseInt","pathAndId","colorPath","x","traverseItemsAndSetKeyedGradient","color_path_len","colorType","oldColorIndex","gradientStartIndex","toBeHashed","traverseItemsAndSetGradient","animation","assignNewSolidColor","traverseItemsAndSetKeyedSolid","traverseItemsAndSetSolid","sketchPickerStyles","default","picker","boxShadow","width","undoStack","redoStack","initAnimation","initState","LottieEditor","state","data","parsedColors","colorPickerBackground","current_layer","rootLayerPath","layer_open","activeGroupId","keyFramedColorType","keyFramedColorIndex","isGradient","gradientIndex","currentFrameTime","totalTime","paused","animationPreviewBackgroundColor","backgroundColorPickerVisible","currentView","fetchError","setColors","setState","toggleLayer","id","getPrevState","stringify","changeColor","event","rgb","r","b","newData","oldStateData","shift","lottieRender","setActiveColorKeyedSolids","setActiveColorSolids","shapeGroupId","setActiveColorKeyedGradient","gradient","setActiveColorGradient","gradientColorI","gradientColorIndex","updateCurrentFrame","currentTime","keyboardControls","keyCode","playPause","seekByArrowKeys","ctrlKey","undo","redo","seekByMouseClick","lottie","goToAndStop","play","currentFrame","playButtonState","clearAllChanges","cleared","prevAnimation","pop","current","toggleBackgroundColorPicker","hideBackgroundColorPicker","wrapperRef","contains","target","setWrapperRef","node","loadNewAnimation","parseAndLoadNewAnimation","newAnimation","result","handleFileDrop","files","reader","FileReader","onload","readAsText","downloadFile","blob","Blob","saveAs","switchEditMode","buildKeyedSolidsList","style","background","padding","borderBottom","borderTop","size","onClick","fontSize","marginLeft","buildKeyedGradientListColorList","color_type","gradient_colors","gradients","groupGradient","buildKeyedGradientList","last","buildGradientList","buildSolidsList","buildShapesList","layer","Object","keys","filter","className","renderParsedColors","reverse","autoHide","autoHideTimeout","autoHideDuration","destroy","loadAnimation","container","document","getElementById","renderer","loop","autoplay","animationData","addEventListener","showFetchError","this","search","window","location","url","URLSearchParams","get","fetch","then","resp","text","body","res","err","catch","require","removeEventListener","hex","ref","onChange","changeBackgroundColor","animationRef","class","onChangeComplete","styles","href","FileDrop","onDrop","renderAnimation","title","track","active","backgroundColor","y","xmax","backgroundColorPicker","React","Component","Boolean","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.2c4d4a02.chunk.js","sourcesContent":["import XXH from 'xxhashjs'\r\n\r\nlet newShapeGroupKeyHash = null\r\n\r\nconst toRGBADecimal = (arr) => arr.map((v,i)=>i!=3 && arr[3] != 0 ?Math.round(v*255):v)\r\nconst toRGBADecimalGradient = (arr) => {\r\n\treturn arr.map((v,i)=> {\r\n\t\tif(i != 0 && v % 4 == 0){ \r\n\t\t\treturn v\r\n\t\t}\r\n\t\telse{\r\n\t\t\treturn Math.round(v*255)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nconst generateNewKeyHash = (val) => {\r\n\treturn XXH.h32(val, 0xABCD ).toString(16)\r\n}\r\n\r\nconst findItemPath = (items) => {\r\n\t\r\n\tlet path = []\r\n\t\r\n\titems.forEach((item,i) => {\r\n\t\t\r\n\t\tif('it' in item){\r\n\t\t\tlet items = findItemPath(item.it)\r\n\t\t\t\r\n\t\t\tif(items.length > 0) {\r\n\t\t\t\titems = items.map(colorObj => {\r\n\t\t\t\t\tcolorObj.itemPath.push(i)\r\n\t\t\t\t\tcolorObj.itemName = 'nm' in item ? item.nm +' -> '+ colorObj.itemName: 'Item ' +i+ ' -> '+ colorObj.itemName\r\n\t\t\t\t\treturn colorObj\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpath = path.concat(items)\r\n\t\t}\r\n\t\telse if(item.ty == 'fl' || item.ty == 'st'){ //solid fill || stroke\r\n\t\t\t\r\n\t\t\tconst itemName = 'nm' in item ? item.nm: item.ty == 'fl' ? 'Fill 1': 'Stroke 1'\r\n\t\t\tif(item.c.a == 0){\r\n\t\t\t\tconst color = toRGBADecimal(item.c.k)\r\n\t\t\t\tpath.push({type:item.ty,itemName:itemName, itemPath:[i], color:color, keyFramed:false})\r\n\t\t\t}\r\n\t\t\telse if(item.c.a == 1){ //color has keyframes\r\n\t\t\t\tlet colors = []\r\n\t\t\t\titem.c.k.forEach((v,i) => {\r\n\t\t\t\t\tif('s' in v){\r\n\t\t\t\t\t\tconst startColor = toRGBADecimal(v.s)\r\n\t\t\t\t\t\t//some json files don't have end color property, use 255 as a filler--not used for anything \r\n\t\t\t\t\t\t//just allows the hash value to be start + end color\r\n\t\t\t\t\t\tconst endColor =   'e' in v ? toRGBADecimal(v.e):[255,255,255,0] \r\n\t\t\t\t\t\tcolors.push({time:v.t,start:startColor,end:endColor,index:i})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tpath.push({ type:item.ty,itemName:itemName, itemPath:[i],color:colors,keyFramed:true})\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(item.ty == 'gf' || item.ty == 'gs'){ //gradient fill/stroke\r\n\t\t\tconst itemName = 'nm' in item ? item.nm: item.ty == 'gf' ? 'Gradient Fill 1': 'Gradient Stroke 1'\r\n\t\t\tif(item.g.k.a == 0){\r\n\t\t\t\tconst color = toRGBADecimalGradient(item.g.k.k)\r\n\t\t\t\tpath.push({type:item.ty,itemName:itemName, itemPath:[i], color:color, keyFramed:false})\r\n\t\t\t}\r\n\t\t\telse if(item.g.k.a == 1){ //gradient has keyframes\r\n\t\t\t\tlet colors = []\r\n\t\t\t\titem.g.k.k.forEach((v,i) => {\r\n\t\t\t\t\tif('s' in v && 'e' in v){\r\n\t\t\t\t\t\tconst startColor = toRGBADecimalGradient(v.s)\r\n\t\t\t\t\t\tconst endColor =   toRGBADecimalGradient(v.e)\r\n\t\t\t\t\t\tcolors.push({time:v.t,start:startColor,end:endColor,index:i})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tpath.push({ type:item.ty,itemName:itemName, itemPath:[i], keyFramed:true,color:colors})\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\treturn path\r\n}\r\n\r\n\r\nconst extractColors = (layers,rootLayersName,assetsIndex = null) => {\r\n\tlet colors = []\r\n\t\r\n\tlayers.forEach((v,i) => {\r\n\t\tif('layers' in v){ //layer embededded in layer\r\n\t\t\t//todo\r\n\t\t}\r\n\t\telse if(\"shapes\" in v){\r\n\t\t\tlet shapes = extractColors(v.shapes,rootLayersName,assetsIndex).map((val) => {\r\n\t\t\t\tval.layerId = rootLayersName +':'+ i + ':'+assetsIndex\r\n\t\t\t\tval.layerName = v.nm\r\n\t\t\t\treturn val\r\n\t\t\t})\r\n\t\t\tcolors = colors.concat(shapes)\r\n\t\t\t\r\n\t\t}\r\n\t\telse if(\"it\" in v) {\r\n\t\t\tlet items = findItemPath(v.it).map((val) =>{\r\n\t\t\t\tval.shapeId = i\r\n\t\t\t\tval.shapeName = v.nm\r\n\t\t\t\t\r\n\t\t\t\treturn val\r\n\t\t\t})\r\n\t\t\tcolors = colors.concat(items)\r\n\t\t}\r\n\t\t\r\n\t})\r\n\treturn colors\r\n}\r\n\r\n\r\nconst parseColors = (jsn, file=false) => {\r\n\t\r\n\tlet parsed = file ? jsn: JSON.parse(jsn)\r\n\t\r\n\tlet layers = {}\r\n\r\n\textractColors(parsed.layers,'main').forEach((colorObj,i) => {\r\n\t\tlet color = colorObj.keyFramed ? colorObj.color[colorObj.color.length - 1].start.join()+colorObj.color[colorObj.color.length - 1].end.join(): colorObj.color.join()\r\n\t\tlet rootItemName = colorObj.itemName.split('->')[0].trim()\r\n\t\tlet key = generateNewKeyHash(rootItemName+':'+color)\r\n\t\tlet layerId = colorObj.layerId.toString()\r\n\r\n\t\tif(layers.hasOwnProperty(layerId)){\r\n\t\t\tif( key in layers[layerId]){\r\n\t\t\t\tlayers[layerId][key].push(colorObj)\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tlayers[layerId][key] = [colorObj.shapeName,colorObj]\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\tlayers[layerId] = {[key]:[colorObj.shapeName,colorObj],layerName:colorObj.layerName}\r\n\t\t}\r\n\t})\r\n\t\r\n\tif(parsed.assets.length != 0){\r\n\t\tparsed.assets.forEach((asset,i) => {\r\n\t\t\tif('layers' in asset){\r\n\t\t\t\textractColors(asset.layers,'assets',i).forEach((colorObj,i) =>{\r\n\t\t\t\t\tlet color = colorObj.keyFramed ? colorObj.color[colorObj.color.length - 1].start.join()+colorObj.color[colorObj.color.length - 1].end.join(): colorObj.color.join()\r\n\t\t\t\t\tlet rootItemName = colorObj.itemName.split('->')[0].trim()\r\n\t\t\t\t\tlet key = generateNewKeyHash(rootItemName+':'+color)\r\n\t\t\t\t\tlet layerId = colorObj.layerId.toString()\r\n\t\t\r\n\t\t\t\t\tif(layers.hasOwnProperty(layerId)){\r\n\t\t\t\t\t\tif( key in layers[layerId]){\r\n\t\t\t\t\t\t\tlayers[layerId][key].push(colorObj)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tlayers[layerId][key] = [colorObj.shapeName,colorObj]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlayers[layerId] = {[key]:[colorObj.shapeName,colorObj],layerName:colorObj.layerName}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\treturn layers\r\n}\r\nconst setGradientKValue = (k,new_color,startIndex) => {\r\n\tlet i = startIndex*4\r\n\tlet j = 0\r\n\tlet count = 3 \r\n\t\r\n\twhile(count > 0){\r\n\t\tk[i] = new_color[j]\r\n\t\ti++\r\n\t\tj++\r\n\t\tcount--\r\n\t}\t\r\n}\r\nconst getLastkeyFramedColor = (k,type) => {\r\n\tlet colors = []\r\n\tk.forEach((obj,i)=>{\r\n\t\tconst end = 'e' in obj ? obj.e: [255,255,255,0] //<----missing end color placeholder\r\n\t\tcolors.push({time:obj.t,start:obj.s,end:end,index:i})\r\n\t})\r\n\t//s:start,e:end\r\n\tconst s = colors[colors.length - 1].start\r\n\tconst e = colors[colors.length - 1].end\r\n\r\n\treturn  type ==\"solid\"? toRGBADecimal(s) + toRGBADecimal(e):toRGBADecimalGradient(s)+toRGBADecimalGradient(e)\r\n\t\r\n}\r\n\r\nconst traverseItemsAndSetKeyedSolid = (json,colorProps,color_path_len) => {\r\n\tlet i = colorProps.colorPath[color_path_len-1]\r\n\tif(color_path_len  > 0){\r\n\t\ttraverseItemsAndSetKeyedSolid(json.it[i],colorProps,color_path_len-1)\r\n\t}\r\n\telse{\r\n\t\tif(colorProps.colorType == 'start'){\r\n\t\t\tlet k = json.c.k[colorProps.oldColorIndex]\r\n\t\t\tif('s' in k) k.s = colorProps.newColor\r\n\t\t}\r\n\t\telse if(colorProps.colorType == 'end'){\r\n\t\t\tlet k = json.c.k[colorProps.oldColorIndex]\r\n\t\t\tif('e' in k) k.e = colorProps.newColor\r\n\t\t}\r\n\t\tlet toBeHashed = getLastkeyFramedColor(json.c.k,'solid')\r\n\t\tnewShapeGroupKeyHash =  generateNewKeyHash(colorProps.rootItemName+':'+toBeHashed)\r\n\t}\r\n}\r\n\r\nconst traverseItemsAndSetKeyedGradient = (json,colorProps,color_path_len) => {\r\n\tlet i = colorProps.colorPath[color_path_len-1]\r\n\tif(color_path_len  > 0){\r\n\t\ttraverseItemsAndSetKeyedGradient(json.it[i],colorProps,color_path_len-1)\r\n\t}\r\n\telse{\r\n\t\tif(colorProps.colorType == 'start') setGradientKValue(json.g.k.k[colorProps.oldColorIndex].s,colorProps.newColor,colorProps.gradientStartIndex)\r\n\t\telse if(colorProps.colorType == 'end') setGradientKValue(json.g.k.k[colorProps.oldColorIndex].e,colorProps.newColor,colorProps.gradientStartIndex)\r\n\t\tlet toBeHashed = getLastkeyFramedColor(json.g.k.k,'gradient')\r\n\t\tnewShapeGroupKeyHash =  generateNewKeyHash(colorProps.rootItemName+':'+toBeHashed)\r\n\t}\r\n}\r\n\r\nconst traverseItemsAndSetGradient = (json,colorProps,color_path_len) => {\r\n\tlet i = colorProps.colorPath[color_path_len-1]\r\n\tif(color_path_len  > 0){\r\n\t\ttraverseItemsAndSetGradient(json.it[i],colorProps,color_path_len-1)\r\n\t}\r\n\telse{\r\n\t\tsetGradientKValue(json.g.k.k,colorProps.newColor,colorProps.gradientStartIndex)\r\n\t\tnewShapeGroupKeyHash = generateNewKeyHash(colorProps.rootItemName+':'+toRGBADecimalGradient(json.g.k.k))\r\n\t}\r\n}\r\n\r\nconst traverseItemsAndSetSolid = (json,colorProps,color_path_len) => {\r\n\tlet i = colorProps.colorPath[color_path_len-1]\r\n\tif(color_path_len  > 0){\r\n\t\ttraverseItemsAndSetSolid(json.it[i],colorProps,color_path_len-1)\r\n\t}\r\n\telse{\r\n\t\tjson.c.k = colorProps.newColor\r\n\t\tnewShapeGroupKeyHash = generateNewKeyHash(colorProps.rootItemName+':'+toRGBADecimal(json.c.k))\r\n\r\n\t}\r\n}\r\n\r\n\r\n\r\nconst assignNewGradientColor = (json,colorProps) => {\r\n\tcolorProps.newColor = colorProps.pickedColor.map((v,i)=> i!=3? parseInt(v)*1.0/255:v)\r\n\tcolorProps.items.forEach((v,i) => {\r\n\t\tif(i != 0){\r\n\t\t\tconst {itemName,itemPath,shapeId,layerId} = v\r\n\t\t\tconst pathAndId = layerId.split(':')\r\n\r\n\t\t\tcolorProps.rootItemName = itemName.split('->')[0].trim()\r\n\t\t\tcolorProps.colorPath = v.itemPath\r\n\r\n\t\t\tlet x = pathAndId[0] == \"main\" ? json.layers[pathAndId[1]].shapes[shapeId]: json.assets[pathAndId[2]].layers[pathAndId[1]].shapes[shapeId]\r\n\t\t\t\tif(colorProps.type == \"keyed\"){\r\n\t\t\t\t\ttraverseItemsAndSetKeyedGradient(\r\n\t\t\t\t\t\tx,\r\n\t\t\t\t\t\tcolorProps,\r\n\t\t\t\t\t\titemPath.length\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\ttraverseItemsAndSetGradient(\r\n\t\t\t\t\t\tx,\r\n\t\t\t\t\t\tcolorProps,\r\n\t\t\t\t\t\titemPath.length\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\r\n\t})\r\n\r\n\tconst parsed = parseColors(json,true)\r\n\treturn {animation:json,colors:parsed,key:newShapeGroupKeyHash}\r\n\r\n\t\r\n}\r\n\r\nconst assignNewSolidColor = (json,colorProps) => {\r\n\tcolorProps.newColor = colorProps.pickedColor.map((v,i)=> i!=3? parseInt(v)*1.0/255:v)\r\n\tcolorProps.items.forEach((v,i) => {\r\n\t\tif(i != 0){\r\n\t\t\tconst {itemName,itemPath,shapeId,layerId} = v\r\n\t\t\tconst pathAndId = layerId.split(':')\r\n\r\n\t\t\tcolorProps.rootItemName = itemName.split('->')[0].trim()\r\n\t\t\tcolorProps.colorPath = v.itemPath\r\n\r\n\t\t\tlet x = pathAndId[0] == \"main\" ? json.layers[pathAndId[1]].shapes[shapeId]: json.assets[pathAndId[2]].layers[pathAndId[1]].shapes[shapeId]\r\n\t\t\t\tif(colorProps.type == \"keyed\"){\r\n\t\t\t\t\ttraverseItemsAndSetKeyedSolid(\r\n\t\t\t\t\t\tx,\r\n\t\t\t\t\t\tcolorProps,\r\n\t\t\t\t\t\titemPath.length\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\ttraverseItemsAndSetSolid(\r\n\t\t\t\t\t\tx,\r\n\t\t\t\t\t\tcolorProps,\r\n\t\t\t\t\t\titemPath.length\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t})\r\n\r\n\tconst parsed = parseColors(json,true)\r\n\treturn {animation:json,colors:parsed,key:newShapeGroupKeyHash}\r\n\r\n\t\r\n}\r\n\r\n\r\n\r\nexport {\r\n\tparseColors,\r\n\tassignNewSolidColor,\r\n\tassignNewGradientColor\r\n}\r\n","import React from 'react';\nimport './assets/css/style.css';\nimport {ChromePicker} from 'react-color';\nimport lottie from 'lottie-web'\nimport {parseColors, assignNewSolidColor, assignNewGradientColor} from './editor'\nimport {MdVpnKey, MdKeyboardArrowDown, MdPlayArrow, MdUndo, MdRedo, MdFileDownload, MdClearAll, MdPause, MdEdit} from 'react-icons/md'\nimport {FaGithub} from 'react-icons/fa'\nimport { Scrollbars } from 'react-custom-scrollbars';\nimport Slider from 'react-input-slider'\nimport FileDrop from 'react-file-drop'\nimport {saveAs} from 'file-saver'\n\nconst sketchPickerStyles = {\n  default: {\n    picker: { // See the individual picker source for which keys to use\n      boxShadow: 'none',\n      //padding:0\n      width:'100%',\n     \n    },\n  },\n}\n//support undo/redo\nlet undoStack = []\nlet redoStack = []\nlet initAnimation = null\nlet initState = {}\n\nclass LottieEditor extends React.Component {\n  state = {\n    data: null,\n    parsedColors:null,\n   \n    colorPickerBackground: [0,0,0,1],\n    \n    current_layer: null,\n    rootLayerPath:null,\n    rootItemName:null,\n    layer_open:false,\n    activeGroupId:null,\n\n    keyFramed:false,\n    keyFramedColorType:null,\n    keyFramedColorIndex:null,\n\n    isGradient:false,\n    gradientIndex:null,\n   \n    currentFrameTime:0,\n    totalTime:0,\n    paused:false,\n\n    animationPreviewBackgroundColor:'#fff',\n    backgroundColorPickerVisible:false,\n    currentView:0,//0:show file drop,1: show loading,2:render animation\n    fetchError:false\n  }\n  componentDidMount(){\n    initState = this.state //for redo/undo and clear all \n    let search = window.location.search;\n    let params = new URLSearchParams(search);\n    let url = params.get('src')\n\n    if(url){\n      this.setState({currentView:1})\n      fetch(url)\n      .then(async resp => {\n        //lottiefiles website returns plain text so get that first and parse\n        let body = await resp.text() \n        try{\n          const res = JSON.parse(body)\n          //check some properties to see if is a valid lottie json file..\n          //not meant to be foolproof -- just to catch mistakes\n          if('v' in res && 'ip' in res && 'op'){\n            this.loadNewAnimation(res)\n          }\n          else{\n            this.setState({currentView:0,fetchError:true})\n          }\n          \n        }\n        catch(err){\n          this.setState({fetchError:true,currentView:0})\n        }\n      })\n      .catch(err =>  this.setState({fetchError:true,currentView:0}))\n    }\n    \n    this.setState({\n      data:require('./assets/animations/watermelon.json') //demo animation\n      },() => {\n       //ugly but for deep copy of the animation data only.. later to clear all the changes\n       //most animation files are less than 1mb so performance shouldn't suffer\n        initAnimation = JSON.parse(JSON.stringify(this.state.data))\n      }\n      )\n    document.addEventListener('mousedown', this.hideBackgroundColorPicker)\n    document.addEventListener(\"keydown\", this.keyboardControls, false)\n  }\n  componentWillUnmount(){\n    document.removeEventListener(\"keydown\", this.keyboardControls, false)\n    document.removeEventListener('mousedown', this.hideBackgroundColorPicker);\n  }\n  setColors = () => {\n    const parsedColors = parseColors(this.state.data,true)\n    this.setState({parsedColors: parsedColors})\n  }\n\n  toggleLayer = (id) => {\n    if(this.state.current_layer == id){\n      this.setState({layer_open:!this.state.layer_open})\n    }\n    else{\n      this.setState({current_layer:id,layer_open:true})\n    } \n  }\n  getPrevState = () =>{ //json stringify for deep copy of the animation data --needed for undo/redo\n    return {...this.state,...{data:JSON.parse(JSON.stringify(this.state.data))}}\n  }\n  changeColor = (color,event) => {\n    if(!this.state.activeGroupId) return\n    const pickedColor = [color.rgb.r,color.rgb.g,color.rgb.b,1]\n    const colorGroup = this.state.parsedColors[this.state.rootLayerPath][this.state.activeGroupId]\n    let newData = null\n    let colorProps = {\n      items:colorGroup,\n      pickedColor:pickedColor\n    }\n    //undo/redo\n    const oldStateData = this.getPrevState()\n    if(undoStack.length < 10){\n      undoStack.push(oldStateData)\n    }\n    else{\n      undoStack.shift()\n      undoStack.push(oldStateData)\n    }\n    redoStack = []\n    \n    if(this.state.keyFramed){\n      colorProps.type = \"keyed\"\n      colorProps.colorType = this.state.keyFramedColorType\n      colorProps.oldColorIndex = this.state.keyFramedColorIndex\n\n      if(this.state.isGradient){\n        colorProps.gradientStartIndex = this.state.gradientIndex\n        newData = assignNewGradientColor(this.state.data,colorProps)\n      }\n      else{\n        newData = assignNewSolidColor(this.state.data,colorProps)\n      }\n    }\n    else{\n        colorProps.type = null\n        if(this.state.isGradient){\n          colorProps.gradientStartIndex = this.state.gradientIndex\n          newData = assignNewGradientColor(this.state.data,colorProps)\n        }\n        else{\n          newData = assignNewSolidColor(this.state.data,colorProps)\n        }\n    }\n    \n    this.setState({\n      parsedColors:newData.colors,\n      activeGroupId:newData.key,\n      colorPickerBackground:pickedColor.join(),\n    }, \n      () => {\n        this.lottieRender()\n    })\n  }\n  setActiveColorKeyedSolids = (layerId,shapeId,colorObj,rootItemName,colorType) => {\n    this.setState({\n      rootLayerPath:layerId,\n      isGradient:false,\n      keyFramed:true,\n      keyFramedColorType:colorType,\n      activeGroupId:shapeId,\n      keyFramedColorIndex:colorObj.index,\n      rootItemName:rootItemName,\n      colorPickerBackground:colorObj[colorType]\n    },\n    //() => lottie.goToAndStop()\n    )\n  }\n  setActiveColorSolids = (colorProps) => { \n    this.setState({\n      rootLayerPath:colorProps.layerId,\n      activeGroupId:colorProps.shapeGroupId,\n      isGradient:false,\n      keyFramed:false,\n      rootItemName:colorProps.rootItemName,\n      colorPickerBackground:colorProps.color\n    }\n    )\n   \n  }\n  \n  setActiveColorKeyedGradient = (colorProps) => {\n    this.setState({\n      rootLayerPath:colorProps.layerId,\n      activeGroupId:colorProps.shapeGroupId,\n      isGradient:true,\n      keyFramed:true,\n      keyFramedColorIndex:colorProps.keyFramedColorIndex,\n      keyFramedColorType:colorProps.colorType,\n      gradientIndex:colorProps.gradientIndex,\n      rootItemName:colorProps.rootItemName,\n      colorPickerBackground:colorProps.gradient\n    })\n    \n  }\n  setActiveColorGradient = (layerId,shapeId,gradientColorI,rootItemName,gradientColorIndex) => {\n    this.setState({\n      rootLayerPath:layerId,\n      isGradient:true,\n      keyFramed:false,\n      activeGroupId:shapeId,\n      gradientIndex:gradientColorIndex,\n      rootItemName:rootItemName,\n      colorPickerBackground:gradientColorI\n    })\n  }\n  updateCurrentFrame = (e) =>{\n    this.setState({currentFrameTime:e.currentTime,totalTime:e.totalTime})\n  }\n\n  keyboardControls = (e)=>{\n    if(e.keyCode == 32) this.playPause()\n    else if(e.keyCode == 37 && this.state.currentFrameTime-1 >= 0) this.seekByArrowKeys(-1)\n    else if(e.keyCode == 39 && this.state.currentFrameTime+1 <= this.state.totalTime) this.seekByArrowKeys(1)\n    else if (e.keyCode == 90 && e.ctrlKey) this.undo()\n    else if (e.keyCode == 89 && e.ctrlKey) this.redo()\n  } \n\n  seekByMouseClick = (val) => {\n    lottie.goToAndStop(val.x,true)\n    if(!this.state.paused){\n      lottie.play()\n    }\n  }\n  seekByArrowKeys = (val) => {//seek using arrow keys or clicking on the track\n    let currentFrame = this.state.currentFrameTime + val\n    lottie.goToAndStop(currentFrame,true)\n    if(!this.state.paused){\n      lottie.play()\n    }\n  }\n  playPause = () => {\n    if(this.state.currentView != 2) return\n    let playButtonState = null\n    if(this.state.paused){\n      lottie.goToAndStop(this.state.currentFrameTime,true)\n      lottie.play()\n      playButtonState = false\n    }\n    else{\n      lottie.goToAndStop(this.state.currentFrameTime,true)\n      playButtonState = true\n    }\n    this.setState({paused:playButtonState})\n    \n  }\n  clearAllChanges = () => {\n    if(undoStack.length == 0) return\n    const cleared = {...initState,...{data:initAnimation,currentView:2}}\n    redoStack = []\n    undoStack = []\n    this.setState(\n      cleared\n      ,()=>{\n        this.setColors()\n        this.lottieRender()\n      }\n      )\n  }\n  undo = () => {//supports up to 10 levels\n    if(undoStack.length == 0) return\n    const prevAnimation = undoStack.pop()\n    redoStack.push(prevAnimation)\n    redoStack.push(this.getPrevState())\n    \n    this.setState(\n      {...prevAnimation,...{animationPreviewBackgroundColor:this.state.animationPreviewBackgroundColor}}\n      ,()=>{\n        this.setColors()\n        this.lottieRender()\n      }\n    )\n   \n  }\n  redo = () => {//supports up to 10 levels\n    if(redoStack.length == 0) return\n    let current = redoStack.pop()\n    let undo = redoStack.pop()\n    undoStack.push(undo)\n    this.setState(\n      {...current,...{animationPreviewBackgroundColor:this.state.animationPreviewBackgroundColor}},\n      ()=>{\n        this.setColors()\n        this.lottieRender()\n      }\n    )\n  }\n  toggleBackgroundColorPicker = () => {\n    this.setState({backgroundColorPickerVisible:!this.state.backgroundColorPickerVisible})\n  }\n  changeBackgroundColor (color,e){\n    this.setState({\n      animationPreviewBackgroundColor:color.hex\n    })  \n  }\n  hideBackgroundColorPicker = (e) => {\n    if (this.wrapperRef && !this.wrapperRef.contains(e.target)) {\n      this.setState({backgroundColorPickerVisible:false})\n    }\n  }\n  setWrapperRef = (node) => {\n    this.wrapperRef = node\n  }\n  \n  loadNewAnimation = (animation) => {\n    initAnimation = animation\n    let x = {...initState ,...{data:animation}}\n    this.setState({...x,...{currentView:2,fetchError:false}},\n      () => {\n        undoStack = []\n        redoStack = []\n        this.setColors()\n        this.lottieRender()\n      }\n    )\n  }\n  parseAndLoadNewAnimation = (e) => {\n    const newAnimation = JSON.parse(e.target.result)\n    this.loadNewAnimation(newAnimation)\n  }\n\n  handleFileDrop = (files,e) => {\n    const reader = new FileReader()\n    reader.onload = this.parseAndLoadNewAnimation;\n    reader.readAsText(files[0])\n  }\n\n  downloadFile = ()=>{\n    if(this.state.currentView != 2) return  \n    const blob = new Blob([JSON.stringify(this.state.data)], {type: \"application/json\"});\n    saveAs(blob,this.state.data.nm)\n  }\n  switchEditMode = () => {\n    this.setState(\n     {currentView:2,fetchError:false},\n      () => {\n        this.setColors()\n        this.lottieRender()\n      }\n    )\n   \n  }\n//----------renders----------------------------\n//---------------------------------------\n  backgroundColorPicker(){\n    if(this.state.backgroundColorPickerVisible){\n      return (\n        <div ref={this.setWrapperRef}>\n        <div className=\"background-color-picker\">\n        <ChromePicker\n          color={this.state.animationPreviewBackgroundColor}\n          onChange={(e) => this.changeBackgroundColor(e)}\n        /> \n        </div>\n        </div>\n      )\n    }\n    return \"\"\n  }\n\n  buildKeyedSolidsList = (items,key) => {\n    let rootItemName = items[1].itemName.split('->')[0].trim()\n    let expand = true\n    if(expand){\n      return (\n        <div style={{background: 'rgba(0, 0, 0, 0.09)'}}>\n          <div style={{padding:'8px 0 8px 30px',borderBottom:'1px solid rgba(0,0,0,.05)',borderTop:'1px solid rgba(0,0,0,.05)'}}><MdKeyboardArrowDown/> {items[0] + ' -> ' + rootItemName} <MdVpnKey size={13}/></div>\n          <ul>\n            {\n              items[1].color.map(v =>\n                <li>\n                  <div onClick={() => {this.setState({paused:true});lottie.goToAndStop(v.time+1,true)}} style={{padding:'5px 0 5px 50px',borderBottom:'1px solid #ddd'}}> <MdKeyboardArrowDown/> t = {v.time + 1}</div>\n                {\n                 \n                  <ul>\n                    <li onClick={() => this.setActiveColorKeyedSolids(items[1].layerId,key,v,rootItemName,'start')} style={{fontSize:12,padding:5,marginLeft:100,background:'rgba('+v.start.join()+')'}}>Start color</li>\n                    <li onClick={() => this.setActiveColorKeyedSolids(items[1].layerId,key,v,rootItemName,'end')} style={{fontSize:12,padding:5,marginLeft:100,background:v.end[3] == 0? '#fff': 'rgba('+v.end.join()+')'}}>End color</li>\n                  </ul>\n                }\n                </li>  \n              )\n            }\n          </ul>\n        </div>\n      )\n    }\n    return (\n      <div>{items[0]}</div>\n    )\n  }\n\n  buildKeyedGradientListColorList = (colorProps,color_type,gradient_colors) => {\n    const gradients = this.groupGradient(gradient_colors)\n    return (\n      <ul>\n        {gradients.map((gradient,i)=>\n            <li \n              onClick={() => this.setActiveColorKeyedGradient({\n                  rootItemName:colorProps.rootItemName,\n                  gradientIndex:i,\n                  gradient:gradient,\n                  layerId:colorProps.layerId,\n                  shapeGroupId:colorProps.shapeGroupId,\n                  colorType:color_type,\n                  keyFramedColorIndex:colorProps.keyFramedColorIndex\n                })} \n              style={{padding:8,marginLeft:20,background:'rgba('+gradient.map((v,i)=>i==3?1:v).join()+')'}}\n            >\n              Gradient  {i+1}\n            </li>\n        \n        )}\n      </ul>\n    )\n  }\n\n  buildKeyedGradientList = (item,key) => {\n    let rootItemName = item[1].itemName.split('->')[0].trim()\n    let expand = true\n\n    if(expand){\n      return (\n        <div style={{background: 'rgba(0, 0, 0, 0.09)'}}>\n          <div style={{padding:'8px 0 8px 30px',borderBottom:'1px solid rgba(0,0,0,.05)',borderTop:'1px solid rgba(0,0,0,.05)'}}><MdKeyboardArrowDown/> {item[0] + ' -> ' + rootItemName} <MdVpnKey size={13}/></div>\n          <ul>\n            {\n              item[1].color.map((v,i) => {\n                return (\n                  <li>\n                    <div onClick={() => lottie.goToAndStop(v.time+1,true)} style={{padding:'5px 0 5px 50px',borderBottom:'1px solid #ddd'}}> <MdKeyboardArrowDown/> t = {v.time + 1}</div>\n                  {\n                  \n                    <ul>\n                      <li style={{fontSize:12,padding:5,marginLeft:60,}}>\n                      <div style={{padding:10}}><MdKeyboardArrowDown/> Start color</div>\n                      {\n                        this.buildKeyedGradientListColorList({\n                          rootItemName: rootItemName,\n                          layerId: item[1].layerId,\n                          shapeGroupId:key,\n                          keyFramedColorIndex:i\n                        },'start',v.start)\n                      }\n                      </li>\n                      <li style={{fontSize:12,padding:5,marginLeft:60,}}>\n                      <MdKeyboardArrowDown/> End color\n                      {this.buildKeyedGradientListColorList({\n                        rootItemName: rootItemName,\n                        layerId: item[1].layerId,\n                        shapeGroupId:key,\n                        keyFramedColorIndex:i\n                      },'end',v.end)}\n                      </li>\n                    </ul>\n                  }\n                  </li>  \n                )}\n              )\n            }\n          </ul>\n        </div>\n      )\n    }\n    return (\n      <div>{item[0]}</div>\n    )\n  }\n  groupGradient = (arr) => {\n    let gradients = [];\n    arr.forEach((e,i) => {\n      const last = gradients[gradients.length - 1];\n      if (!last || last.length === 4) {\n        gradients.push([e]);\n      } else {\n        last.push(e);\n      }\n    }); \n    return gradients\n  }\n  buildGradientList = (item,key) => {\n    let rootItemName = item[1].itemName.split('->')[0].trim()\n    let gradients = this.groupGradient(item[1].color)\n    \n    return (\n      <div>\n        <div style={{padding:'8px 0 8px 40px'}}>{item[0]}</div>\n        <ul>\n          {gradients.map((gradient,i) => \n            <li onClick={()=> this.setActiveColorGradient(item[1].layerId,key,gradient,rootItemName,i)} style={{padding:5,marginLeft:60,background:'rgba('+gradient.join()+')'}}>\n              Gradient {i+1}\n            </li>\n            )}\n        </ul>\n      </div>\n    )\n  }\n  \n  buildSolidsList = (item,shapeId) => {\n    let rootItemName = item[1].itemName.split('->')[0].trim()\n    return (\n      <div style={{background:'rgba(0,0,0,.10)'}}>\n      <ul>\n        <li \n        onClick={() => this.setActiveColorSolids(\n          {\n            rootItemName:rootItemName,\n            layerId:item[1].layerId,\n            shapeGroupId:shapeId,\n            color:item[1].color\n          }\n          )}  \n        style={{fontSize:12,marginLeft:30,padding:5,background:'rgba('+item[1].color.join()+')'}}>{item[0] +' -> '+ rootItemName}</li>\n      </ul>\n      </div>\n    )\n  }\n\n  buildShapesList = (layer,layerId) => {\n    let shapes = Object.keys(layer).filter(key=> key != \"layerName\")\n   \n    if(this.state.current_layer == layerId && this.state.layer_open){\n        return (\n          <div>\n            <div onClick={() => this.toggleLayer(layerId)} className=\"layerRoot\">\n            <div><span className=\"playArrowDown\"><MdPlayArrow  size={15}/></span> {layer.layerName}</div>\n            </div>\n          <ul>\n            {\n              shapes.map((key,i) => {\n                if(layer[key][1].keyFramed){\n                  if(layer[key][1].type == 'gf' || layer[key][1].type == 'gs'){\n                    return this.buildKeyedGradientList(layer[key],key)\n                  }\n                  else{\n                    return this.buildKeyedSolidsList(layer[key],key)\n                  }\n                }\n                else{\n                  if(layer[key][1].type == 'gf' || layer[key][1].type == 'gs'){\n                    return this.buildGradientList(layer[key],key)\n                  }\n                  else{\n                    return this.buildSolidsList(layer[key],key)\n                  }\n                }\n\n              })\n            }\n          </ul>\n          </div>\n        )\n    }\n    return (\n      <div onClick={() => this.toggleLayer(layerId)} className=\"layerRoot\">\n            <div><MdPlayArrow size={15}/> {layer.layerName}</div>\n            </div>\n    )\n  }\n\n  renderParsedColors = () =>{\n    \n    if(this.state.parsedColors == null) return null\n    \n    let layers = Object.keys(this.state.parsedColors).reverse();\n    //console.log(layers)\n    return (\n      <Scrollbars\n      autoHide\n      autoHideTimeout={1000}\n      autoHideDuration={200}\n       \n       className=\"parsedColorsWrapper\" >\n      <div >\n        <ul>\n          {\n            layers.map((key,i)=>\n              <li key={this.state.parsedColors[key].layerName} className=\"parsedColorItem\">\n                {this.buildShapesList(this.state.parsedColors[key],i)}\n              </li>\n              )\n          }\n        </ul>\n      </div>\n      </Scrollbars>\n    )\n  }\n\n  lottieRender = () => {\n    lottie.destroy()\n\n    let animation = lottie.loadAnimation({\n      container: document.getElementById(\"preview\"), \n      renderer: \"svg\",\n      loop: true,\n      autoplay:true,\n      animationData: this.state.data,\n    });\n    if(this.state.paused) animation.goToAndStop(this.state.currentFrameTime,true)\n    animation.addEventListener('enterFrame',this.updateCurrentFrame)\n    \n  }\n\n  renderAnimation(){\n    if(this.state.currentView == 2){\n      return (\n        <div ref={this.animationRef} id=\"preview\"/>\n      )\n    }\n    else if(this.state.currentView == 1){\n      return (\n        <div>\n          Loading...\n        </div>\n      )\n    }\n    return (\n      <div className=\"drop-files-wrapper\">\n          <p>Drag and drop lottie files here or </p><br/><br/>\n          <div onClick={() => this.switchEditMode()} class=\"button\">\n          Edit demo\n         \n          <span><MdEdit/></span>\n        </div>\n      </div>\n    )\n  }\n  showFetchError = ()=>{\n    if(this.state.fetchError) {\n      return (\n        <div className=\"fetch-error\"><span>Couldn't fetch json data from provided url. Drag and drop the file above</span></div>\n      )\n    }\n  }\n  render() {\n  return (\n    <div className=\"main\">\n      <div className=\"sidebarWrapper\">\n      <div className=\"colorPicker\">\n          <ChromePicker  \n            color={ 'rgba('+this.state.colorPickerBackground+')'}\n            onChangeComplete={this.changeColor} \n            styles={sketchPickerStyles}\n          />\n         \n        </div>\n       \n        {this.renderParsedColors()}\n\n      </div>\n      <div className=\"previewWrapper\">\n        <a target=\"_blank\" href=\"https://github.com/magna25/lottie-editor\" id=\"github-link\"> <p><FaGithub/></p> <p>v1.0.0</p></a>\n\n        <div className=\"previewContainer\"  style={{background:this.state.animationPreviewBackgroundColor}}>\n            <FileDrop onDrop={this.handleFileDrop}>\n            {this.renderAnimation()}\n            </FileDrop>\n        </div>\n      \n        \n        <div className=\"previewControls\">\n          {this.showFetchError()}\n          <div className=\"controls\" style={{padding:20}}>\n            <div><MdFileDownload onClick={() => this.downloadFile()} color={this.state.currentView != 2?'gray':'#000'} title=\"Download\" size={25}/></div>\n            <div onClick={() => this.clearAllChanges()}><MdClearAll color={undoStack.length == 0?'gray':'#000'} title=\"Clear All\" size={25}/></div>\n            <div onClick={() => this.undo()}><MdUndo color={undoStack.length == 0?'gray':'#000'}title=\"Undo\" size={30}/></div>\n            <div onClick={() => this.redo()}><MdRedo color={redoStack.length == 0?'gray':'#000'} title=\"Redo\" size={30}/></div>\n            <div onClick={() => this.playPause()}>{!this.state.paused ? <MdPause color={this.state.currentView != 2?'gray':'#000'} title=\"Pause\" size={30}/> : <MdPlayArrow color={this.state.currentView != 2?'gray':'#000'} title=\"Play\" size={30}/>}</div>\n            <div>\n              <div>{this.state.currentFrameTime < 10? '0'+Math.round(this.state.currentFrameTime):Math.round(this.state.currentFrameTime)}/{this.state.totalTime}</div>\n              <div className=\"controls-slider\">\n                <Slider\n                  styles={{\n                    track: {\n                      width:'100%',\n                    },\n                    active: {\n                      backgroundColor: 'gray'\n                    },\n                  }}\n                  y\n                  xmax={this.state.totalTime}\n                  x = {this.state.currentFrameTime}\n                  onChange={this.seekByMouseClick}\n                />\n              </div>\n            </div>\n            <div style={{background:this.state.animationPreviewBackgroundColor}} onClick={() => this.toggleBackgroundColorPicker()}> BG</div>\n          </div>\n          {this.backgroundColorPicker()}\n        </div>\n        \n      </div>\n    </div>\n  );\n  }\n}\n\nexport default LottieEditor;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport LottieEditor from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<LottieEditor />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}